---
Test
---
## Dynamic Date

|com.groundtruth.test.Util.Gadget.TimeGetter    |
|getDate?     |daysToAdd|hoursToAdd|minutesToAdd|
|$Today=      |         |-7        |            |
|$After_7Days=|7        |-7        |            |
|$Yesterday=  |-1       |-7        |            |

!3 Test setup
!| com.groundtruth.test.AdsManagerApi.AdsManagerApiRequestor                                                                                                                     |
|testTitle                    |testId|getResults?|getStatusCode?|getId?             |getUrl?|method|headers|browseEndPoint   |apiPrefix|addon     |payload                       |
|create campaign to be deleted|TS-1  |true       |200           |$deletedCampaignId=|       |post  |       |${browseEndPoint}|/api     |/campaigns|{"name": "Deleted Campaign"}  |
|create active campaign 1     |TS-2  |true       |200           |$activeCampaignId1=|       |post  |       |${browseEndPoint}|/api     |/campaigns|{"name": "Active Campaign #1"}|
|create active campaign 2     |TS-3  |true       |200           |$activeCampaignId2=|       |post  |       |${browseEndPoint}|/api     |/campaigns|{"name":"Active Campaign #2"} |

!| com.groundtruth.test.AdsManagerApi.AdsManagerApiRequestor                                                                                                                                                                 |
|testTitle                            |testId|getResults?|getStatusCode?|getId?                    |getUrl?|method|headers|browseEndPoint   |apiPrefix|addon    |campaignId        |payload                                  |
|add adgroup to campaign to be deleted|TS-4  |true       |200           |$adgroupInDeletedCampaign=|       |post  |       |${browseEndPoint}|/api     |/adgroups|$deletedCampaignId|{"name":"Adgroup in Deleted Campaign"}   |
|add adgroup to active campaign 1     |TS-5  |true       |200           |$activeAdgroupId1=        |       |post  |       |${browseEndPoint}|/api     |/adgroups|$activeCampaignId1|{"name":"Adgroup in Active Campaign 1"}  |
|add second adgroup to campaign 1     |TS-6  |true       |200           |$activeAdgroupId2=        |       |post  |       |${browseEndPoint}|/api     |/adgroups|$activeCampaignId1|{"name":"Adgroup 2 in Active Campaign 1"}|
|add adgroup to active campaign 2     |TS-7  |true       |200           |$campaign2AdgroupId=      |       |post  |       |${browseEndPoint}|/api     |/adgroups|$activeCampaignId2|{"name":"Adgroup in Active Campaign 2"}  |
|add adgroup to be deleted            |TS-8  |true       |200           |$deletedAdgroupId=        |       |post  |       |${browseEndPoint}|/api     |/adgroups|$activeCampaignId1|{"name":"Adgroup to be deleted"}         |

!| com.groundtruth.test.AdsManagerApi.AdsManagerApiRequestor                                                                                                                                                                                                                                                                                                                                        |
|testTitle                             |testId|getResults?|getStatusCode?|getId?                     |getUrl?|method|headers|browseEndPoint   |apiPrefix|campaignId        |adgroupId                |addon     |payload                                                                                                                                                                            |
|add creative to campaign to be deleted|TS-9  |true       |200           |$creativeInDeletedCampaign=|       |post  |       |${browseEndPoint}|/api     |$deletedCampaignId|$adgroupInDeletedCampaign|/creatives|{"name":"Trafficking API Test Creative", "type":"image", "size":"320x50", "banner_image_url":"${320x50url}", "click_through_url":"https://ads-qa3.groundtruth.com"}                |
|add creative to first adgroup         |TS-10 |true       |200           |$creativeId1=              |       |post  |       |${browseEndPoint}|/api     |$activeCampaignId1|$activeAdgroupId1        |/creatives|{"name":"Trafficking API Test Creative1", "type":"image", "size":"320x50", "banner_image_url":"${320x50url}", "click_through_url":"https://ads-qa3.groundtruth.com"}               |
|add creative to be deleted            |TS-11 |true       |200           |$deletedCreativeId=        |       |post  |       |${browseEndPoint}|/api     |$activeCampaignId1|$activeAdgroupId1        |/creatives|{"name":"Trafficking API Test Creative - to be deleted", "type":"image", "size":"320x50", "banner_image_url":"${320x50url}", "click_through_url":"https://ads-qa3.groundtruth.com"}|
|add creative to second adgroup        |TS-12 |true       |200           |$creativeId2=              |       |post  |       |${browseEndPoint}|/api     |$activeCampaignId1|$activeAdgroupId2        |/creatives|{"name":"Trafficking API Test Creative - AG2", "type":"image", "size":"320x50", "banner_image_url":"${320x50url}", "click_through_url":"https://ads-qa3.groundtruth.com"}          |
|add creative to adgroup to be deleted |TS-13 |true       |200           |$creativeInDeletedAdgroup= |       |post  |       |${browseEndPoint}|/api     |$activeCampaignId1|$deletedAdgroupId        |/creatives|{"name":"Trafficking API Test Creative - Deleted AG", "type":"image", "size":"320x50", "banner_image_url":"${320x50url}", "click_through_url":"https://ads-qa3.groundtruth.com"}   |
|add creative to second campaign       |TS-13 |true       |200           |$creativeInCampaign2=      |       |post  |       |${browseEndPoint}|/api     |$activeCampaignId2|$campaign2AdgroupId      |/creatives|{"name":"Trafficking API Test Creative - Deleted AG", "type":"image", "size":"320x50", "banner_image_url":"${320x50url}", "click_through_url":"https://ads-qa3.groundtruth.com"}   |

!| com.groundtruth.test.AdsManagerApi.AdsManagerApiRequestor                                                                                                               |
|testTitle                    |testId|getResults?|getStatusCode?|getUrl?|method|headers|browseEndPoint   |apiPrefix|campaignId        |adgroupId        |creativeId        |
|delete creative to be deleted|TS-14 |true       |200           |       |delete|       |${browseEndPoint}|/api     |$activeCampaignId1|$activeAdgroupId1|$deletedCreativeId|

!| com.groundtruth.test.AdsManagerApi.AdsManagerApiRequestor                                                                          |
|testTitle                    |testId|getResults?|getStatusCode?|getUrl?|method|headers|browseEndPoint   |apiPrefix|campaignId        |
|delete campaign to be deleted|TS-15 |true       |200           |       |delete|       |${browseEndPoint}|/api     |$deletedCampaignId|

!| com.groundtruth.test.AdsManagerApi.AdsManagerApiRequestor                                                                                           |
|testTitle                   |testId|getResults?|getStatusCode?|getUrl?|method|headers|browseEndPoint   |apiPrefix|campaignId        |adgroupId        |
|delete adgroup to be deleted|TS-16 |true       |200           |       |delete|       |${browseEndPoint}|/api     |$activeCampaignId1|$deletedAdgroupId|

!3 Tests
!| com.groundtruth.test.AdsManagerApi.AdsManagerApiRequestor                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|testTitle                             |testId|getResults?|getStatusCode?|getMessage?                                                            |getId?      |getName?                      |getStatus_id?|getStatus_name?|getType?|getSize?|getBanner_image_url?|getClick_through_url?           |getUrl?|method|headers|browseEndPoint   |apiPrefix|campaignId                   |adgroupId                   |creativeId                   |addon                                                              |payload         |
|Change status from 1 to 2             |1     |true       |200           |                                                                       |$creativeId1|Trafficking API Test Creative1|2            |paused         |image   |320x50  |${320x50url}        |https://ads-qa3.groundtruth.com/|       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": 2 }  |
|Change status from 2 to 2             |2     |true       |400           |No changes could be found on Creative to warrant an update             |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": 2 }  |
|Change status from 2 to 1             |3     |true       |200           |                                                                       |$creativeId1|Trafficking API Test Creative1|1            |active         |image   |320x50  |${320x50url}        |https://ads-qa3.groundtruth.com/|       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": 1 }  |
|Change status from 1 to 1             |4     |true       |400           |No changes could be found on Creative to warrant an update             |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": 1 }  |
|Change status to 0                    |5     |true       |400           |Input payload validation failed                                        |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": 0 }  |
|Change status to 3                    |6     |true       |400           |Input payload validation failed                                        |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": 3 }  |
|Change status to "1"                  |7     |true       |400           |Input payload validation failed                                        |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": "1" }|
|Change status to "a"                  |8     |true       |400           |Input payload validation failed                                        |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": "a" }|
|Creative id doesn't belong to campaign|9     |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId2           |$activeAdgroupId1           |$creativeId1                 |/status                                                            |{"status": 1 }  |
|Creative id doesn't belong to adgroup |10    |true       |400           |No creative with id $creativeId1 exists under adgroup $activeAdgroupId2|            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId2           |$creativeId1                 |/status                                                            |{"status": 1 }  |
|Campaign belongs to different tenant  |11    |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |${campaignInDifferentTenant} |${adgroupInDifferentTenant} |${creativeInDifferentTenant} |/status                                                            |{"status": 1 }  |
|Campaign belongs to different account |12    |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |${campaignInDifferentAccount}|${adgroupInDifferentAccount}|${creativeInDifferentAccount}|/status                                                            |{"status": 1 }  |
|Campaign deleted                      |13    |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$deletedCampaignId           |$adgroupInDeletedCampaign   |$creativeInDeletedCampaign   |/status                                                            |{"status": 2 }  |
|Campaign id invalid                   |14    |false      |404           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |${invalidCampaignId}         |${invalidCampaignId}        |${invalidCampaignId}         |/status                                                            |{"status": 1 }  |
|Campaign id nonexistent               |15    |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |${nonexistentCampaignId}     |${nonexistentCampaignId}    |${nonexistentCampaignId}     |/status                                                            |{"status": 1 }  |
|Campaign id not included              |16    |false      |404           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |                             |                            |                             |/campaigns/adgroups/$activeAdgroupId1/creatives/$creativeId1/status|{"status": 1 }  |
|Adgroup deleted                       |17    |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$deletedAdgroupId           |$creativeInDeletedAdgroup    |/status                                                            |{"status": 1 }  |
|Adgroup id invalid                    |18    |false      |404           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |${invalidCampaignId}        |$creativeId1                 |/status                                                            |{"status": 1 }  |
|Adgroup id nonexistent                |19    |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |${nonexistentCampaignId}    |$creativeId1                 |/status                                                            |{"status": 1 }  |
|Adgroup id not included               |20    |false      |404           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |                             |                            |                             |/adgroups/creatives/$creativeId1/status                            |{"status": 1 }  |
|Creative deleted                      |21    |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |$deletedCreativeId           |/status                                                            |{"status": 1 }  |
|Creative id invalid                   |22    |false      |404           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |${invalidCampaignId}         |/status                                                            |{"status": 1 }  |
|Creative id nonexistent               |23    |true       |400           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |${nonexistentCampaignId}     |/status                                                            |{"status": 1 }  |
|Creative id not included              |24    |false      |404           |                                                                       |            |                              |             |               |        |        |                    |                                |       |put   |       |${browseEndPoint}|/api     |$activeCampaignId1           |$activeAdgroupId1           |                             |/creatives/status                                                  |{"status": 1 }  |

!3 Test Teardown
!| com.groundtruth.test.AdsManagerApi.AdsManagerApiRequestor                                                                          |
|testTitle                    |testId|getResults?|getStatusCode?|getUrl?|method|headers|browseEndPoint   |apiPrefix|campaignId        |
|delete campaign to be deleted|TD-1  |true       |400           |       |delete|       |${browseEndPoint}|/api     |$deletedCampaignId|
|delete active campaign1      |TD-2  |true       |200           |       |delete|       |${browseEndPoint}|/api     |$activeCampaignId1|
|delete active campaign 2     |TD-3  |true       |200           |       |delete|       |${browseEndPoint}|/api     |$activeCampaignId2|
